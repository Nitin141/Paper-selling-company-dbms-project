<!DOCTYPE html>
<html lang="en">

<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Branch details</title>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
 integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

<body>
 <nav class="navbar navbar-expand-lg navbar-dark bg-dark">

  <a class="navbar-brand" href="#">
   <img src="../newspaper.svg" width="30" height="30" class="d-inline-block align-top" alt="">

   PaperGo
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
   aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
   <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
   <ul class="navbar-nav mr-auto ">
    <li class="nav-item active">
     <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
    </li>
    </li>
    <li class="nav-item">
     <a class="nav-link" href="#">Features</a>
    </li>
    <li class="nav-item">
     <a class="nav-link" href="#">Tables</a>
    </li>
    <li class="nav-item">
     <a class="nav-link" href="#">About</a>
    </li>
    <li class="nav-item">
     <a class="nav-link" href="#">Support</a>
    </li>
   </ul>
   <!--==========================-->
   <ul class="nav navbar-nav navbar-right">
    <li class="nav-item">
     <a class="nav-link" href="#">login</a>
    </li>
   </ul>
  </div>
 </nav>
 <div id="message">
 </div>
 <table class="table table-dark" id="table">
  <thead id="tablehead">
  </thead>
  <tbody id="tablebody">
  </tbody>
 </table>
</body>
 <script>
  $.fn.serializeObject = function () {
   var o = {};
   var a = this.serializeArray();
   $.each(a, function () {
    if (o[this.name] !== undefined) {
     if (!o[this.name].push) {
      o[this.name] = [o[this.name]];
     }
     o[this.name].push(this.value || "");
    } else {
     o[this.name] = this.value || "";
    }
   });
   return o;
  };
  let message = document.getElementById("message");
  let msgjson = JSON.stringify($("#message").serializeObject());
  let myArray = [];
  $.ajax({
   type: "GET",
   url: "http://localhost:4000/branchall",
   data: msgjson,
   success: function (result) {
    myArray = result;
    buildTable(myArray);
    console.log(myArray);
   },
   error: function () {
    let message = document.getElementById("message");
    message.innerHTML = `<div class="alert alert-danger" role="alert">
       </div>`;
    setTimeout(() => {
     message.innerHTML = "";
    }, 2000);
   },
   dataType: "json",
   contentType: "application/json"
  });


  function buildTable(data) {
   html1 = `<tr>
            <th scope="col">Branch Id</th>
            <th scope="col">BranchName</th>
            <th scope="col">Manager Id</th>
            <th scope="col">Manager Start Date</th>
          </tr>`
   tablehead.innerHTML = html1;
   for (var i = 0; i < data.length; i++) {
    html = `<tr>
      <td>${data[i].branch_id}</td>
      <td>${data[i].branch_name}</td>
      <td>${data[i].mgr_id}</td>
      <td>${data[i].mgr_start_date}</td>
    </tr>`
    tablebody.innerHTML += html;
    html = '';
   }
  }

 </script>